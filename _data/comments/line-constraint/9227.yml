id: 9227
date: 2013-01-02 13:52:02 -0500
author: William
parent: line-constraint
avatar: http://0.gravatar.com/avatar/9abfec71f4798ded76d242c8df48067e?s=96&d=mm&r=g
message: "<p>The u vector should be the locally transformed world axis (and normalized) passed to the joint. So you should be able to specify the axis of the joint (but using the center of masses is fine). You will also need the local tangent of that vector as well. You will also need an anchor point for the joint. This will allow you to compute the r vectors for both bodies (we need the r vectors so we can determine if the bodies have deviated from the tangent).</p>\n<p>The local axis and tangent should be computed on initialization. Then in each iteration we transform those into world coordinates using the rotation matrix (only) of the body that we fixed the axis with.</p>\n<p>One thing that may be tricky is solving the system. The b vector is going to be (which I didn't expand in the post):</p>\n<p>b = -Jv<br />\nb = [ t<sup>T</sup> r<sub>a</sub> x t -t<sup>T</sup> -(r<sub>b</sub> + u) x t ] * [ v<sub>a</sub> w<sub>a</sub> v<sub>b</sub> w<sub>b</sub> ]<sup>T</sup><br />\nb = t<sup>T</sup> * v<sub>a</sub> + (r<sub>a</sub> x t) * w<sub>a</sub> &#8211; t<sup>T</sup> * v<sub>b</sub> &#8211; ((r<sub>b</sub> + u) x t) * w<sub>b</sub></p>\n<p>Where u and t are the world space axis and tangent of the joint that we have from initialization.</p>\n<p>William</p>"